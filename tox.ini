[tox]
# see https://devguide.python.org/versions/
env_list = py{3.13.0b4,3.12.4,3.11.9,3.10.14,3.9.19,3.8.19,3.7.17,3.6.15,3.5.10,2.7.18}
setenv = VIRTUALENV_DISCOVERY=pyenv

[testenv]
package = externals
allowlist_externals = sh
commands = sh -c 'python -m doctest tests/test_*.txt'

[testenv:py3.12.4]
allowlist_externals = mkdir,pdm
commands_pre =
    pdm install --dev
    mkdir -p tmp
commands =
    pdm run pytest
commands_post =
    mkdir -p docs/badge
    pdm run genbadge tests --local -i tmp/junit.xml -o docs/badge/tests.svg
    pdm run genbadge coverage --local -i tmp/coverage.xml -o docs/badge/coverage.svg
parallel_show_output = true

[pytest]
testpaths = tests
addopts =
    --junitxml=tmp/junit.xml
    --cov=caseutil
    --cov-report=term
    --cov-report=html
    --cov-report=xml

[coverage:run]
branch = true
data_file = tmp/.coverage
[coverage:report]
precision = 1
[coverage:html]
directory = tmp/htmlcov
[coverage:xml]
output = tmp/coverage.xml
