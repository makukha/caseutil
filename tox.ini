[tox]
# see https://devguide.python.org/versions/
env_list =
    py2.7.18
    py3.5.10
    py3.6.15
    py3.7.17
    py3.8.19
    py3.9.19
    py3.10.14
    py3.11.9
    py3.12.4
    py3.13.0rc1
setenv = VIRTUALENV_DISCOVERY=pyenv

[testenv]
package = external
allowlist_externals = sh
commands = sh -c 'python -m doctest tests/test_*.txt'

[testenv:py3.12.4]
allowlist_externals = mkdir,pdm
commands_pre =
    pdm install --dev
    mkdir -p tmp
commands =
    pdm run pytest
commands_post =
    mkdir -p docs/badge
    pdm run genbadge tests --local -i tmp/junit.xml -o docs/badge/tests.svg
    pdm run genbadge coverage --local -i tmp/coverage.xml -o docs/badge/coverage.svg
parallel_show_output = true

[pytest]
testpaths = tests
addopts =
    --junitxml=tmp/junit.xml
    --cov=caseutil
    --cov-report=term
    --cov-report=html
    --cov-report=xml

[coverage:run]
branch = true
data_file = tmp/.coverage
[coverage:report]
precision = 1
[coverage:html]
directory = tmp/htmlcov
[coverage:xml]
output = tmp/coverage.xml
